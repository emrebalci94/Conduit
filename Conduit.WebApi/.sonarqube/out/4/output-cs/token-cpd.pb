ø9
TC:\Users\EXT02D13704\Desktop\Conduit\Conduit.WebApi\Controllers\ArticleController.cs
	namespace 	
Conduit
 
. 
WebApi 
. 
Controllers $
{ 
[ 
Produces 
( 
$str  
)  !
]! "
[ 
Route 

(
 
$str 
) 
] 
[ 

EnableCors 
( 
$str 
) 
] 
public 

class 
ArticleController "
:# $

Controller% /
{ 
private 
readonly 
IArticleServices )
_articleServices* :
;: ;
private 
readonly  
IArticleTagsServices -
_articleTagServices. A
;A B
public 
ArticleController  
(  !
IArticleServices! 1
articleServices2 A
,A B 
IArticleTagsServicesC W
articleTagsServicesX k
)k l
{ 	
_articleServices 
= 
articleServices .
;. /
_articleTagServices 
=  !
articleTagsServices" 5
;5 6
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
List 
< 
Article &
>& '
>' (
Get) ,
(, -
)- .
{ 	
return 
await 
Task 
. 
Run !
(! "
(" #
)# $
=>% '
_articleServices( 8
.8 9
GetList9 @
(@ A
)A B
)B C
;C D
} 	
[   	
HttpGet  	 
]   
public!! 
async!! 
Task!! 
<!! 
ArticleListModel!! *
>!!* +
GetArticleListModel!!, ?
(!!? @
[!!@ A
	FromQuery!!A J
]!!J K
string!!L R
tag!!S V
,!!V W
[!!X Y
	FromQuery!!Y b
]!!b c
int!!d g
?!!g h
offset!!i o
,!!o p
[!!q r
	FromQuery!!r {
]!!{ |
int	!!} Ä
?
!!Ä Å
limit
!!Ç á
)
!!á à
{"" 	
return## 
await## 
_articleServices## )
.##) *
GetListModel##* 6
(##6 7
new##7 :
ArticleQuery##; G
(##G H
tag##H K
,##K L
offset##M S
,##S T
limit##U Z
)##Z [
)##[ \
;##\ ]
}$$ 	
[&& 	
HttpGet&&	 
]&& 
['' 	
Route''	 
('' 
$str'' $
)''$ %
]''% &
public(( 
List(( 
<(( 
Article(( 
>(( 
GetListWithComments(( 0
(((0 1
)((1 2
{)) 	
return++ 
_articleServices++ #
.++# $
GetIncludes++$ /
(++/ 0
p++0 1
=>++2 4
p++5 6
.++6 7
Comments++7 ?
)++? @
.++@ A
ToList++A G
(++G H
)++H I
;++I J
},, 	
[.. 	
HttpPut..	 
(.. 
$str.. 
).. 
].. 
public// 
async// 
Task// 
<// 
IActionResult// '
>//' (
Put//) ,
(//, -
int//- 0
id//1 3
,//3 4
[//5 6
FromBody//6 >
]//> ?
Article//? F
article//G N
)//N O
{00 	
article22 
.22 
Id22 
=22 
id22 
;22 
var33 
durum33 
=33 
await33 
_articleServices33 .
.33. /
Update33/ 5
(335 6
article336 =
)33= >
;33> ?
if44 
(44 
durum44 
.44 
Errors44 
!=44 
null44  $
)44$ %
{55 
return66 
Ok66 
(66 
durum66 
)66  
;66  !
}77 
return88 

BadRequest88 
(88 
durum88 #
)88# $
;88$ %
}99 	
[;; 	
HttpPost;;	 
];; 
public<< 
async<< 
Task<< 
<<< 
IActionResult<< '
><<' (
Post<<) -
(<<- .
[<<. /
FromBody<</ 7
]<<7 8
Article<<8 ?
article<<@ G
)<<G H
{== 	
var>> 
durum>> 
=>> 
await>> 
_articleServices>> .
.>>. /
Insert>>/ 5
(>>5 6
article>>6 =
)>>= >
;>>> ?
if?? 
(?? 
durum?? 
.?? 
Errors?? 
!=?? 
null??  $
)??$ %
{@@ 
returnAA 
OkAA 
(AA 
durumAA 
)AA  
;AA  !
}BB 
returnCC 

BadRequestCC 
(CC 
durumCC #
)CC# $
;CC$ %
}DD 	
[FF 	

HttpDeleteFF	 
(FF 
$strFF 
)FF 
]FF 
publicGG 
asyncGG 
TaskGG 
<GG 
IActionResultGG '
>GG' (
DeleteGG) /
(GG/ 0
intGG0 3
idGG4 6
)GG6 7
{HH 	
varII 
durumII 
=II 
awaitII 
_articleServicesII .
.II. /
DeleteII/ 5
(II5 6
idII6 8
)II8 9
;II9 :
ifJJ 
(JJ 
durumJJ 
.JJ 
ErrorsJJ 
!=JJ 
nullJJ  $
)JJ$ %
{KK 
returnLL 
OkLL 
(LL 
durumLL 
)LL  
;LL  !
}MM 
returnNN 

BadRequestNN 
(NN 
durumNN #
)NN# $
;NN$ %
}OO 	
[QQ 	
HttpPostQQ	 
(QQ 
$strQQ 
)QQ 
]QQ 
publicRR 
asyncRR 
TaskRR 
<RR 
IActionResultRR '
>RR' (
ArticleTagsAsyncRR) 9
(RR9 :
[RR: ;
FromBodyRR; C
]RRC D

ArticleTagRRE O
tagRRP S
)RRS T
{SS 	
varTT 
durumTT 
=TT 
awaitTT 
_articleTagServicesTT 1
.TT1 2
InsertTT2 8
(TT8 9
tagTT9 <
)TT< =
;TT= >
ifUU 
(UU 
durumUU 
.UU 
ErrorsUU 
!=UU 
nullUU  $
)UU$ %
{VV 
returnWW 
OkWW 
(WW 
durumWW 
)WW  
;WW  !
}XX 
returnYY 

BadRequestYY 
(YY 
durumYY #
)YY# $
;YY$ %
}ZZ 	
}[[ 
}\\ ∏!
TC:\Users\EXT02D13704\Desktop\Conduit\Conduit.WebApi\Controllers\CommentController.cs
	namespace 	
Conduit
 
. 
WebApi 
. 
Controllers $
{ 
[ 
Produces 
( 
$str  
)  !
]! "
[ 
Route 

(
 
$str 
) 
] 
[ 

EnableCors 
( 
$str 
) 
] 
public 

class 
CommentController "
:# $

Controller% /
{ 
private 
readonly 
ICommentSercices )
_commentSercices* :
;: ;
public 
CommentController  
(  !
ICommentSercices! 1
commentSercices2 A
)A B
{ 	
_commentSercices 
= 
commentSercices .
;. /
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
List 
< 

CommentDto )
>) *
>* +
GetAsync, 4
(4 5
)5 6
{ 	
return 
await 
_commentSercices )
.) *
GetListAsync* 6
(6 7
)7 8
;8 9
}   	
["" 	
HttpPost""	 
]"" 
public## 
async## 
Task## 
<## 
IActionResult## '
>##' (
	PostAsync##) 2
(##2 3
[##3 4
FromBody##4 <
]##< =

CommentDto##> H

commentDto##I S
)##S T
{$$ 	
var%% 
message%% 
=%% 
await%% 
_commentSercices%%  0
.%%0 1
InsertAsync%%1 <
(%%< =

commentDto%%= G
)%%G H
;%%H I
if&& 
(&& 
message&& 
.&& 
Errors&& 
!=&& !
null&&" &
)&&& '
{'' 
return(( 
Ok(( 
((( 
message(( !
)((! "
;((" #
})) 
return** 

BadRequest** 
(** 
message** %
)**% &
;**& '
}++ 	
[-- 	
HttpPut--	 
]-- 
public.. 
async.. 
Task.. 
<.. 
IActionResult.. '
>..' (
PutAsync..) 1
(..1 2
[..2 3
FromBody..3 ;
]..; <

CommentDto..= G

commentDto..H R
)..R S
{// 	
var11 
message11 
=11 
await11 
_commentSercices11  0
.110 1
UpdateAsync111 <
(11< =

commentDto11= G
)11G H
;11H I
if22 
(22 
message22 
.22 
Errors22 
!=22 !
null22" &
)22& '
{33 
return44 
Ok44 
(44 
message44 !
)44! "
;44" #
}55 
return66 

BadRequest66 
(66 
message66 %
)66% &
;66& '
}77 	
[:: 	

HttpDelete::	 
(:: 
$str:: 
):: 
]:: 
public;; 
async;; 
Task;; 
<;; 
IActionResult;; '
>;;' (
DeleteAsync;;) 4
(;;4 5
int;;5 8
id;;9 ;
);;; <
{<< 	
var== 
message== 
=== 
await== 
_commentSercices== /
.==/ 0
DeleteAsync==0 ;
(==; <
id==< >
)==> ?
;==? @
if>> 
(>> 
message>> 
.>> 
Errors>> 
!=>> !
null>>" &
)>>& '
{?? 
return@@ 
Ok@@ 
(@@ 
message@@ !
)@@! "
;@@" #
}AA 
returnBB 

BadRequestBB 
(BB 
messageBB %
)BB% &
;BB& '
}CC 	
}DD 
}EE ‹
PC:\Users\EXT02D13704\Desktop\Conduit\Conduit.WebApi\Controllers\TagController.cs
	namespace 	
Conduit
 
. 
WebApi 
. 
Controllers $
{ 
[ 
Produces 
( 
$str  
)  !
]! "
[ 
Route 

(
 
$str 
) 
] 
[ 

EnableCors 
( 
$str 
) 
] 
public 

class 
TagController 
:  

Controller! +
{ 
private 
readonly 
ITagServices %
_tagServices& 2
;2 3
public 
TagController 
( 
ITagServices )
tagServices* 5
)5 6
{ 	
_tagServices 
= 
tagServices &
;& '
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
List 
< 
TagViewModel +
>+ ,
>, -
Get. 1
(1 2
)2 3
{ 	
return 
await 
_tagServices %
.% &
GetList& -
(- .
). /
;/ 0
}   	
["" 	
HttpGet""	 
("" 
$str"" 
)"" 
]"" 
public## 
List## 
<## 
Tag## 
>## 
GetList##  
(##  !
)##! "
{$$ 	
return%% 
_tagServices%% 
.%%  
GetIncludes%%  +
(%%+ ,
p%%, -
=>%%. 0
p%%1 2
.%%2 3
ArticleTags%%3 >
)%%> ?
.%%? @
ToList%%@ F
(%%F G
)%%G H
;%%H I
}&& 	
['' 	
HttpPost''	 
]'' 
public(( 
async(( 
Task(( 
<(( 
IActionResult(( '
>((' (
	PostAsync(() 2
(((2 3
[((3 4
FromBody((4 <
]((< =
Tag((= @
tag((A D
)((D E
{)) 	
var** 
durum** 
=** 
await** 
_tagServices** *
.*** +
InsertAsync**+ 6
(**6 7
tag**7 :
)**: ;
;**; <
if++ 
(++ 
durum++ 
.++ 
Errors++ 
!=++ 
null++  $
)++$ %
{,, 
return-- 
Ok-- 
(-- 
durum-- 
)--  
;--  !
}.. 
return// 

BadRequest// 
(// 
durum// #
)//# $
;//$ %
}11 	
[33 	

HttpDelete33	 
]33 
public44 
async44 
Task44 
<44 
IActionResult44 '
>44' (
DeleteAsync44) 4
(444 5
[445 6
FromBody446 >
]44> ?
Tag44? B
tag44C F
)44F G
{55 	
var66 
durum66 
=66 
await66 
_tagServices66 *
.66* +
DeleteAsync66+ 6
(666 7
tag667 :
)66: ;
;66; <
if77 
(77 
durum77 
.77 
Errors77 
!=77 
null77  $
)77$ %
{88 
return99 
Ok99 
(99 
durum99 
)99  
;99  !
}:: 
return;; 

BadRequest;; 
(;; 
durum;; #
);;# $
;;;$ %
}<< 	
}== 
}>> í0
RC:\Users\EXT02D13704\Desktop\Conduit\Conduit.WebApi\Controllers\TokenController.cs
	namespace 	
Conduit
 
. 
WebApi 
. 
Controllers $
{ 
[ 
Produces 
( 
$str  
)  !
]! "
[ 
Route 

(
 
$str 
) 
] 
[ 

EnableCors 
( 
$str 
) 
] 
[ 
AllowAnonymous 
( 
) 
] 
public 

class 
TokenController  
:! "

Controller# -
{ 
private 
readonly 
ITokenServices '
_tokenServices( 6
;6 7
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
TokenController 
( 
ITokenServices -
tokenServices. ;
,; <
IConfiguration< J
configurationK X
)X Y
{ 	
_tokenServices 
= 
tokenServices *
;* +
Configuration   
=   
configuration   )
;  ) *
}!! 	
[## 	
HttpPost##	 
(## 
$str## 
)## 
]## 
public$$ 
async$$ 
Task$$ 
<$$ 
IActionResult$$ '
>$$' (
GetTokenAsync$$) 6
($$6 7
[$$7 8
FromBody$$8 @
]$$@ A
UserDto$$A H
user$$I M
)$$M N
{%% 	
if'' 
('' 
await'' 
_tokenServices'' $
.''$ %+
IsValidUsernameAndPasswordAsync''% D
(''D E
user''E I
.''I J
UserName''J R
,''R S
user''T X
.''X Y
Password''Y a
)''a b
)''b c
{(( 
var)) 
	gelenUser)) 
=)) 
await)) $
_tokenServices))% 3
.))3 4
GetUserAsync))4 @
())@ A
user))A E
.))E F
UserName))F N
)))N O
;))O P
return** 
new** 
ObjectResult** '
(**' (
GenerateToken**( 5
(**5 6
	gelenUser**6 ?
)**? @
)**@ A
;**A B
}++ 
return,, 
Unauthorized,, 
(,,  
),,  !
;,,! "
}-- 	
private11 
string11 
GenerateToken11 $
(11$ %
Domain11% +
.11+ ,
User11, 0
user111 5
)115 6
{22 	
var44 

parameters44 
=44 
new44  
Claim44! &
[44& '
]44' (
{55 
new66 
Claim66 
(66 #
JwtRegisteredClaimNames66 1
.661 2

UniqueName662 <
,66< =
user66= A
.66A B
UserName66B J
)66J K
,66K L
new77 
Claim77 
(77 #
JwtRegisteredClaimNames77 1
.771 2
NameId772 8
,778 9
user779 =
.77= >
Id77> @
.77@ A
ToString77A I
(77I J
)77J K
)77K L
,77L M
new88 
Claim88 
(88 #
JwtRegisteredClaimNames88 1
.881 2
Email882 7
,887 8
user888 <
.88< =
Email88= B
)88B C
}:: 
;:: 
SecurityKey<< 
securityKey<< #
=<<$ %
new<<& ) 
SymmetricSecurityKey<<* >
(<<> ?
CryptoHelper<<? K
.<<K L
GetByte<<L S
(<<S T
(<<T U
string<<U [
)<<[ \
Convert<<\ c
.<<c d

ChangeType<<d n
(<<n o
Configuration<<o |
[<<| }
$str	<<} û
]
<<û ü
,
<<ü †
typeof
<<° ß
(
<<ß ®
string
<<® Æ
)
<<Æ Ø
)
<<Ø ∞
)
<<∞ ±
)
<<± ≤
;
<<≤ ≥
var>> 
token>> 
=>> 
new>> 
JwtSecurityToken>> ,
(>>, -
issuer?? 
:?? 
(?? 
string?? 
)??  
Convert??  '
.??' (

ChangeType??( 2
(??2 3
Configuration??3 @
[??@ A
$str??A ]
]??] ^
,??^ _
typeof??` f
(??f g
string??g m
)??m n
)??n o
,??o p
audience@@ 
:@@ 
(@@ 
string@@ !
)@@! "
Convert@@" )
.@@) *

ChangeType@@* 4
(@@4 5
Configuration@@5 B
[@@B C
$str@@C a
]@@a b
,@@b c
typeof@@d j
(@@j k
string@@k q
)@@q r
)@@r s
,@@s t
claimsAA 
:AA 

parametersAA "
,AA" #
expiresBB 
:BB 
DateTimeBB !
.BB! "
NowBB" %
.BB% &

AddMinutesBB& 0
(BB0 1
(BB1 2
doubleBB2 8
)BB8 9
ConvertBB9 @
.BB@ A

ChangeTypeBBA K
(BBK L
ConfigurationBBL Y
[BBY Z
$strBBZ x
]BBx y
,BBy z
typeof	BB{ Å
(
BBÅ Ç
double
BBÇ à
)
BBà â
)
BBâ ä
)
BBä ã
,
BBã å
signingCredentialsCC "
:CC" #
newCC$ '
SigningCredentialsCC( :
(CC: ;
securityKeyCC; F
,CCF G
SecurityAlgorithmsCCH Z
.CCZ [

HmacSha256CC[ e
)CCe f
)DD 
;DD 
returnFF 
newFF #
JwtSecurityTokenHandlerFF .
(FF. /
)FF/ 0
.FF0 1

WriteTokenFF1 ;
(FF; <
tokenFF< A
)FFA B
;FFB C
}GG 	
}JJ 
}KK …A
QC:\Users\EXT02D13704\Desktop\Conduit\Conduit.WebApi\Controllers\UserController.cs
	namespace 	
Conduit
 
. 
WebApi 
. 
Controllers $
{ 
[ 
Produces 
( 
$str  
)  !
]! "
[ 

EnableCors 
( 
$str 
) 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
UserController 
:  !

Controller" ,
{ 
private 
readonly 
IUserServices &
_userServices' 4
;4 5
private 
readonly !
IFollowedUserServices .
_flowedUserServices/ B
;B C
private 
readonly $
IArticleFavoriteServices 1$
_articleFavoriteServices2 J
;J K
public 
UserController 
( 
IUserServices +
userServices, 8
,8 9!
IFollowedUserServices: O
flowedUserServicesP b
,b c$
IArticleFavoriteServicesd |$
articleFavoriteServices	} î
)
î ï
{ 	
_userServices 
= 
userServices (
;( )
_flowedUserServices 
=  !
flowedUserServices" 4
;4 5$
_articleFavoriteServices $
=% &#
articleFavoriteServices' >
;> ?
} 	
[   	
HttpGet  	 
]   
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
GetAsync!!) 1
(!!1 2
)!!2 3
{"" 	
var## 
list## 
=## 
await## 
_userServices## *
.##* +
GetList##+ 2
(##2 3
)##3 4
;##4 5
return$$ 
new$$ 
ObjectResult$$ #
($$# $
list$$$ (
.$$( )
Select$$) /
($$/ 0
p$$0 1
=>$$2 4
new$$5 8
{$$9 :
p$$; <
.$$< =
UserName$$= E
,$$E F
p$$G H
.$$H I
Email$$I N
,$$N O
p$$P Q
.$$Q R
	FirstName$$R [
,$$[ \
p$$] ^
.$$^ _
LastName$$_ g
}$$h i
)$$i j
.$$j k
ToList$$k q
($$q r
)$$r s
)$$s t
;$$t u
}%% 	
['' 	
HttpPost''	 
]'' 
public(( 
async(( 
Task(( 
<(( 
IActionResult(( '
>((' (
	PostAsync(() 2
(((2 3
[((3 4
FromBody((4 <
]((< =
UserDto((= D
userDto((E L
)((L M
{)) 	
if++ 
(++ 

ModelState++ 
.++ 
IsValid++ "
)++" #
{,, 
var-- 
durum-- 
=-- 
await--  
_userServices--! .
.--. /
InsertAsync--/ :
(--: ;
userDto--; B
)--B C
;--C D
if.. 
(.. 
durum.. 
... 
Errors..  
!=..! #
null..$ (
)..( )
{// 
return00 
Ok00 
(00 
durum00 #
)00# $
;00$ %
}11 
return22 
Ok22 
(22 
durum22 
)22  
;22  !
}33 
return44 

BadRequest44 
(44 

ModelState44 (
)44( )
;44) *
}55 	
[77 	
HttpPut77	 
]77 
public88 
async88 
Task88 
<88 
IActionResult88 '
>88' (
PutAsync88) 1
(881 2
[882 3
FromBody883 ;
]88; <
UserDto88< C
userDto88D K
)88K L
{99 	
if;; 
(;; 

ModelState;; 
.;; 
IsValid;; "
);;" #
{<< 
var== 
durum== 
=== 
await== !
_userServices==" /
.==/ 0
UpdateAsync==0 ;
(==; <
userDto==< C
)==C D
;==D E
if>> 
(>> 
durum>> 
.>> 
Errors>>  
!=>>! #
null>>$ (
)>>( )
{?? 
return@@ 
Ok@@ 
(@@ 
durum@@ #
)@@# $
;@@$ %
}AA 
returnBB 

BadRequestBB !
(BB! "
durumBB" '
)BB' (
;BB( )
}CC 
returnDD 

BadRequestDD 
(DD 

ModelStateDD (
)DD( )
;DD) *
}EE 	
[GG 	

HttpDeleteGG	 
(GG 
$strGG 
)GG 
]GG 
publicHH 
asyncHH 
TaskHH 
<HH 
IActionResultHH '
>HH' (
DeleteAsyncHH) 4
(HH4 5
intHH5 8
idHH9 ;
)HH; <
{II 	
varKK 
durumKK 
=KK 
awaitKK 
_userServicesKK *
.KK* +
DeleteAsyncKK+ 6
(KK6 7
idKK7 9
)KK9 :
;KK: ;
ifLL 
(LL 
durumLL 
.LL 
ErrorsLL 
!=LL 
nullLL  $
)LL$ %
{MM 
returnNN 
OkNN 
(NN 
durumNN 
)NN  
;NN  !
}OO 
returnPP 

BadRequestPP 
(PP 
durumPP #
)PP# $
;PP$ %
}QQ 	
[SS 	
	AuthorizeSS	 
(SS 
)SS 
]SS 
[TT 	
HttpPostTT	 
(TT 
$strTT #
)TT# $
]TT$ %
publicUU 
asyncUU 
TaskUU 
<UU 
IActionResultUU '
>UU' (
FollowUserAsyncUU) 8
(UU8 9
intUU9 <
idUU= ?
)UU? @
{VV 	
varWW 
userIdWW 
=WW 
ConvertWW  
.WW  !
ToInt32WW! (
(WW( )
UserWW) -
.WW- .
	FindFirstWW. 7
(WW7 8
SystemWW8 >
.WW> ?
SecurityWW? G
.WWG H
ClaimsWWH N
.WWN O

ClaimTypesWWO Y
.WWY Z
NameIdentifierWWZ h
)WWh i
.WWi j
ValueWWj o
)WWo p
;WWp q
varXX 
durumXX 
=XX 
awaitXX 
_flowedUserServicesXX 0
.XX0 1
FollowUserAsyncXX1 @
(XX@ A
idXXA C
,XXC D
userIdXXE K
)XXK L
;XXL M
ifYY 
(YY 
durumYY 
.YY 
ErrorsYY 
!=YY 
nullYY  $
)YY$ %
{ZZ 
return[[ 
Ok[[ 
([[ 
durum[[ 
)[[  
;[[  !
}\\ 
return]] 

BadRequest]] 
(]] 
durum]] #
)]]# $
;]]$ %
}__ 	
[aa 	
HttpPostaa	 
(aa 
$straa (
)aa( )
]aa) *
publicbb 
asyncbb 
Taskbb 
<bb 
IActionResultbb '
>bb' ( 
FavoriteArticleAsyncbb) =
(bb= >
intbb> A
idbbB D
,bbD E
intbbF I
	articleIdbbJ S
)bbS T
{cc 	
vardd 
durumdd 
=dd 
awaitdd $
_articleFavoriteServicesdd 5
.dd5 6
AddFavoriteArticledd6 H
(ddH I
idddI K
,ddK L
	articleIdddM V
)ddV W
;ddW X
ifee 
(ee 
durumee 
.ee 
Errorsee 
!=ee 
nullee  $
)ee$ %
{ff 
returngg 
Okgg 
(gg 
durumgg 
)gg  
;gg  !
}hh 
returnii 

BadRequestii 
(ii 
durumii #
)ii# $
;ii$ %
}jj 	
}kk 
}ll Ä
SC:\Users\EXT02D13704\Desktop\Conduit\Conduit.WebApi\Controllers\ValuesController.cs
	namespace		 	
Conduit		
 
.		 
WebApi		 
.		 
Controllers		 $
{

 
[ 
Route 

(
 
$str 
) 
] 
[ 

EnableCors 
( 
$str 
) 
] 
public 

class 
ValuesController !
:" #

Controller$ .
{ 
[ 	
HttpGet	 
] 
public 
IEnumerable 
< 
string !
>! "
Get# &
(& '
)' (
{ 	
return 
new 
string 
[ 
] 
{  !
$str" *
,* +
$str, 4
}5 6
;6 7
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
string 
Get 
( 
int 
id  
)  !
{ 	
return 
$str 
; 
} 	
[ 	
HttpPost	 
] 
public 
void 
Post 
( 
[ 
FromBody "
]" #
string# )
value* /
)/ 0
{   	
}!! 	
[$$ 	
HttpPut$$	 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 
void%% 
Put%% 
(%% 
int%% 
id%% 
,%% 
[%%  !
FromBody%%! )
]%%) *
string%%* 0
value%%1 6
)%%6 7
{&& 	
}'' 	
[** 	

HttpDelete**	 
(** 
$str** 
)** 
]** 
public++ 
void++ 
Delete++ 
(++ 
int++ 
id++ !
)++! "
{,, 	
}-- 	
[// 	
HttpGet//	 
(// 
$str// 
)// 
]// 
[00 	
	Authorize00	 
(00 
)00 
]00 
public11 
List11 
<11 
string11 
>11 
GetToken11 $
(11$ %
)11% &
{22 	
List33 
<33 
string33 
>33 
list33 
=33 
new33  #
List33$ (
<33( )
string33) /
>33/ 0
(330 1
)331 2
;332 3
foreach44 
(44 
var44 
claim44 
in44 !
HttpContext44" -
.44- .
User44. 2
.442 3
Claims443 9
)449 :
{55 
list66 
.66 
Add66 
(66 
String66 
.66  
Format66  &
(66& '
$str66' L
,66L M
claim66N S
.66S T
Type66T X
,66X Y
claim66Z _
.66_ `
Value66` e
)66e f
)66f g
;66g h
}77 
return88 
list88 
;88 
}99 	
[;; 	
HttpGet;;	 
(;; 
$str;; 
);; 
];; 
[<< 	
	Authorize<<	 
(<< 
)<< 
]<< 
public== 
string== 

GetTokenId==  
(==  !
)==! "
{>> 	
return@@ 
User@@ 
.@@ 
	FindFirst@@ !
(@@! "
System@@" (
.@@( )
Security@@) 1
.@@1 2
Claims@@2 8
.@@8 9

ClaimTypes@@9 C
.@@C D
NameIdentifier@@D R
)@@R S
.@@S T
Value@@T Y
;@@Y Z
}AA 	
}BB 
}CC Î
>C:\Users\EXT02D13704\Desktop\Conduit\Conduit.WebApi\Program.cs
	namespace 	
Conduit
 
. 
WebApi 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
BuildWebHost 
( 
args 
) 
. 
Run "
(" #
)# $
;$ %
} 	
public 
static 
IWebHost 
BuildWebHost +
(+ ,
string, 2
[2 3
]3 4
args5 9
)9 :
=>; =
WebHost 
.  
CreateDefaultBuilder (
(( )
args) -
)- .
. 

UseStartup 
< 
Startup #
># $
($ %
)% &
. 
Build 
( 
) 
; 
} 
} ô]
>C:\Users\EXT02D13704\Desktop\Conduit\Conduit.WebApi\Startup.cs
	namespace 	
Conduit
 
. 
WebApi 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public"" 
void"" 
ConfigureServices"" %
(""% &
IServiceCollection""& 8
services""9 A
)""A B
{## 	
services%% 
.%% 
AddCors%% 
(%% 
options%% $
=>%%% '
{&& 
options'' 
.'' 
	AddPolicy'' !
(''! "
$str''" ,
,'', -
builder(( 
=>(( 
{)) 
builder** 
.++ 
AllowAnyOrigin++ '
(++' (
)++( )
.,, 
AllowAnyMethod,, '
(,,' (
),,( )
.-- 
AllowAnyHeader-- '
(--' (
)--( )
... 
AllowCredentials.. )
(..) *
)..* +
;..+ ,
}// 
)// 
;// 
}00 
)00 
;00 
services22 
.22 
AddDbContext22 !
<22! "
ConduitContext22" 0
>220 1
(221 2
option222 8
=>229 ;
{33 
option44 
.44 
UseSqlServer44 #
(44# $
Configuration44$ 1
.441 2
GetConnectionString442 E
(44E F
$str44F Y
)44Y Z
)44Z [
;44[ \
}66 
)66 
;66 
var99 
	mapConfig99 
=99 
new99 

AutoMapper99  *
.99* +
MapperConfiguration99+ >
(99> ?
cfg99? B
=>99C E
{:: 
cfg;; 
.;; 

AddProfile;; 
(;; 
new;; "+
AutoMappingProfileConfiguration;;# B
(;;B C
);;C D
);;D E
;;;E F
}<< 
)<< 
;<< 
var== 
mapper== 
=== 
	mapConfig== "
.==" #
CreateMapper==# /
(==/ 0
)==0 1
;==1 2
services?? 
.?? 
	AddScoped?? 
(?? 
typeof?? %
(??% &
IRepository??& 1
<??1 2
>??2 3
)??3 4
,??4 5
typeof??6 <
(??< =
EfRepositoryBase??= M
<??M N
>??N O
)??O P
)??P Q
;??Q R
services@@ 
.@@ 
	AddScoped@@ 
<@@ 
ITagServices@@ +
,@@+ ,
EfTagManager@@- 9
>@@9 :
(@@: ;
)@@; <
;@@< =
servicesAA 
.AA 
	AddScopedAA 
<AA 
IArticleServicesAA /
,AA/ 0
EfArticleManagerAA1 A
>AAA B
(AAB C
)AAC D
;AAD E
servicesBB 
.BB 
	AddScopedBB 
<BB 
IUserServicesBB ,
,BB, -
EfUserManagerBB. ;
>BB; <
(BB< =
)BB= >
;BB> ?
servicesCC 
.CC 
	AddScopedCC 
<CC 
ITokenServicesCC -
,CC- .
EfUserManagerCC/ <
>CC< =
(CC= >
)CC> ?
;CC? @
servicesDD 
.DD 
	AddScopedDD 
<DD !
IFollowedUserServicesDD 4
,DD4 5!
EfFollowedUserManagerDD6 K
>DDK L
(DDL M
)DDM N
;DDN O
servicesEE 
.EE 
	AddScopedEE 
<EE  
IArticleTagsServicesEE 3
,EE3 4
EfArticleTagManagerEE5 H
>EEH I
(EEI J
)EEJ K
;EEK L
servicesFF 
.FF 
	AddScopedFF 
<FF $
IArticleFavoriteServicesFF 7
,FF7 8$
EfArticleFavoriteManagerFF9 Q
>FFQ R
(FFR S
)FFS T
;FFT U
servicesGG 
.GG 
	AddScopedGG 
<GG 
ICommentSercicesGG /
,GG/ 0
EfCommentManagerGG1 A
>GGA B
(GGB C
)GGC D
;GGD E
servicesHH 
.HH 
AddSingletonHH !
<HH! "
IConfigurationHH" 0
>HH0 1
(HH1 2
ConfigurationHH2 ?
)HH? @
;HH@ A
servicesII 
.II 
AddSingletonII !
(II! "
mapperII" (
)II( )
;II) *
servicesJJ 
.JJ 
AddMvcJJ 
(JJ 
)JJ 
.KK 
AddJsonOptionsKK 
(KK  
optionKK  &
=>KK' )
optionKK* 0
.KK0 1
SerializerSettingsKK1 C
.KKC D!
ReferenceLoopHandlingKKD Y
=KKZ [

NewtonsoftKK\ f
.KKf g
JsonKKg k
.KKk l"
ReferenceLoopHandling	KKl Å
.
KKÅ Ç
Ignore
KKÇ à
)
KKà â
;
KKâ ä
servicesOO 
.OO 
AddSwaggerGenOO "
(OO" #
optionOO# )
=>OO* ,
{PP 
optionQQ 
.QQ 

SwaggerDocQQ !
(QQ! "
$strQQ" .
,QQ. /
newQQ0 3
SwashbuckleQQ4 ?
.QQ? @

AspNetCoreQQ@ J
.QQJ K
SwaggerQQK R
.QQR S
InfoQQS W
{QQX Y
TitleQQZ _
=QQ` a
$strQQb o
,QQo p
VersionQQq x
=QQy z
$strQQ{ 
}
QQÄ Å
)
QQÅ Ç
;
QQÇ É
}SS 
)SS 
;SS 
services[[ 
.[[ 
AddAuthentication[[ &
([[& '
options[[' .
=>[[/ 1
{\\ 
options]] 
.]] %
DefaultAuthenticateScheme]] 1
=]]2 3
JwtBearerDefaults]]4 E
.]]E F 
AuthenticationScheme]]F Z
;]]Z [
options^^ 
.^^ "
DefaultChallengeScheme^^ .
=^^/ 0
JwtBearerDefaults^^1 B
.^^B C 
AuthenticationScheme^^C W
;^^W X
}__ 
)__ 
.`` 
AddJwtBearer`` 
(`` 
options`` !
=>``" $
{aa 
optionsbb 
.bb %
TokenValidationParametersbb 1
=bb2 3
newbb4 7
	Microsoftbb8 A
.bbA B
IdentityModelbbB O
.bbO P
TokensbbP V
.bbV W%
TokenValidationParametersbbW p
{cc 
ValidateAudienceee $
=ee% &
(ee' (
boolee( ,
)ee, -
Convertee- 4
.ee4 5

ChangeTypeee5 ?
(ee? @
Configurationee@ M
[eeM N
$streeN o
]eeo p
,eep q
typeofeeq w
(eew x
booleex |
)ee| }
)ee} ~
,ee~ 
ValidAudienceff !
=ff" #
(ff$ %
stringff% +
)ff+ ,
Convertff, 3
.ff3 4

ChangeTypeff4 >
(ff> ?
Configurationff? L
[ffL M
$strffM k
]ffk l
,ffl m
typeofffn t
(fft u
stringffu {
)ff{ |
)ff| }
,ff} ~
ValidateIssuergg "
=gg# $
(gg% &
boolgg& *
)gg* +
Convertgg+ 2
.gg2 3

ChangeTypegg3 =
(gg= >
Configurationgg> K
[ggK L
$strggL k
]ggk l
,ggl m
typeofggn t
(ggt u
boolggu y
)ggy z
)ggz {
,gg{ |
ValidIssuerhh 
=hh  !
(hh" #
stringhh# )
)hh) *
Converthh* 1
.hh1 2

ChangeTypehh2 <
(hh< =
Configurationhh= J
[hhJ K
$strhhK g
]hhg h
,hhh i
typeofhhj p
(hhp q
stringhhq w
)hhw x
)hhx y
,hhy z
ValidateLifetimeii $
=ii% &
(ii' (
boolii( ,
)ii, -
Convertii- 4
.ii4 5

ChangeTypeii5 ?
(ii? @
Configurationii@ M
[iiM N
$striiN o
]iio p
,iip q
typeofiir x
(iix y
booliiy }
)ii} ~
)ii~ 
,	ii Ä$
ValidateIssuerSigningKeyjj ,
=jj- .
(jj/ 0
booljj0 4
)jj4 5
Convertjj5 <
.jj< =

ChangeTypejj= G
(jjG H
ConfigurationjjH U
[jjU V
$strjjV 
]	jj Ä
,
jjÄ Å
typeof
jjÇ à
(
jjà â
bool
jjâ ç
)
jjç é
)
jjé è
,
jjè ê
IssuerSigningKeykk $
=kk% &
newkk' * 
SymmetricSecurityKeykk+ ?
(kk? @
Systemkk@ F
.kkF G
TextkkG K
.kkK L
EncodingkkL T
.kkT U
UTF8kkU Y
.kkY Z
GetByteskkZ b
(kkb c
(kkc d
stringkkd j
)kkj k
Convertkkk r
.kkr s

ChangeTypekks }
(kk} ~
Configuration	kk~ ã
[
kkã å
$str
kkå ≠
]
kk≠ Æ
,
kkÆ Ø
typeof
kk∞ ∂
(
kk∂ ∑
string
kk∑ Ω
)
kkΩ æ
)
kkæ ø
)
kkø ¿
)
kk¿ ¡
}ll 
;ll 
optionsmm 
.mm 
Eventsmm 
=mm  
newmm! $
JwtBearerEventsmm% 4
{nn 
OnTokenValidatedoo $
=oo% &
ctxoo' *
=>oo+ -
{pp 
returnrr 
Taskrr #
.rr# $
CompletedTaskrr$ 1
;rr1 2
}ss 
,ss "
OnAuthenticationFailedtt *
=tt+ ,
ctxtt- 0
=>tt1 3
{uu 
returnww 
Taskww #
.ww# $
FromExceptionww$ 1
(ww1 2
ctxww2 5
.ww5 6
	Exceptionww6 ?
)ww? @
;ww@ A
}xx 
}yy 
;yy 
}zz 
)zz 
;zz 
}~~ 	
public
ÅÅ 
void
ÅÅ 
	Configure
ÅÅ 
(
ÅÅ !
IApplicationBuilder
ÅÅ 1
app
ÅÅ2 5
,
ÅÅ5 6!
IHostingEnvironment
ÅÅ7 J
env
ÅÅK N
)
ÅÅN O
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 
env
ÉÉ 
.
ÉÉ 
IsDevelopment
ÉÉ !
(
ÉÉ! "
)
ÉÉ" #
)
ÉÉ# $
{
ÑÑ 
app
ÖÖ 
.
ÖÖ '
UseDeveloperExceptionPage
ÖÖ -
(
ÖÖ- .
)
ÖÖ. /
;
ÖÖ/ 0
}
ÜÜ 
app
àà 
.
àà 
UseCors
àà 
(
àà 
$str
àà "
)
àà" #
;
àà# $
app
ää 
.
ää 
UseAuthentication
ää !
(
ää! "
)
ää" #
;
ää# $
app
çç 
.
çç 

UseSwagger
çç 
(
çç 
)
çç 
;
çç 
app
éé 
.
éé 
UseSwaggerUI
éé 
(
éé 
option
éé #
=>
éé$ &
{
èè 
option
êê 
.
êê 
SwaggerEndpoint
êê &
(
êê& '
$str
êê' I
,
êêI J
$str
êêK X
)
êêX Y
;
êêY Z
}
íí 
)
íí 
;
íí 
app
îî 
.
îî 
UseMvc
îî 
(
îî 
)
îî 
;
îî 
}
ññ 	
}
óó 
}òò 